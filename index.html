<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>切れ者カウンター</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #141E30, #243B55);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
    }
    .slot-selector {
      margin-bottom: 20px;
    }
    .slot-selector button {
      background: #ff9966;
      background: linear-gradient(45deg, #ff5e62, #ff9966);
      border: none;
      color: white;
      padding: 8px 14px;
      margin: 4px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: transform 0.1s, box-shadow 0.1s;
    }
    .slot-selector button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
    }
    .slot-selector button.active {
      box-shadow: 0 0 10px #fff;
    }
    .card {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 16px;
      text-align: center;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
      width: 220px;
      transition: transform 0.2s ease-in-out;
      position: relative;
    }
    .card h2 {
      margin: 0 0 10px;
      font-size: 20px;
    }
    .count {
      font-size: 18px;
      margin: 8px 0;
    }
    button.action {
      background: #00c6ff;
      background: linear-gradient(45deg, #0072ff, #00c6ff);
      border: none;
      color: white;
      padding: 8px 12px;
      margin: 4px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: transform 0.1s, box-shadow 0.1s;
    }
    button.action:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
    }
    button.action:active {
      transform: scale(0.95);
    }
    .shake {
      animation: shake 0.3s infinite;
    }
    @keyframes shake {
      0% { transform: translate(2px, 1px) rotate(0deg); }
      20% { transform: translate(-1px, -2px) rotate(-1deg); }
      40% { transform: translate(-3px, 0px) rotate(1deg); }
      60% { transform: translate(3px, 2px) rotate(0deg); }
      80% { transform: translate(1px, -1px) rotate(1deg); }
      100% { transform: translate(-1px, 2px) rotate(-1deg); }
    }
    .fly-away {
      animation: fly 0.8s forwards;
    }
    @keyframes fly {
      0% { transform: translate(0, 0) scale(1); opacity: 1; }
      100% { transform: var(--fly-x, 300px) var(--fly-y, -300px) scale(0.1); opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="slot-selector">
    <button id="btn1" onclick="selectSlot(1)">データ1</button>
    <button id="btn2" onclick="selectSlot(2)">データ2</button>
    <button id="btn3" onclick="selectSlot(3)">データ3</button>
  </div>

  <div class="card" id="card">
    <h2 id="title">データ1</h2>
    <div class="count">育成回数: <span id="grow">0</span></div>
    <div class="count">切れ者: <span id="kire">0</span></div>
    <button class="action" onclick="increment('grow')">育成回数</button>
    <button class="action" onclick="increment('kire')">切れ者</button>
    <button class="action" onclick="resetCounts()">リセット</button>
    <button class="action" onclick="explode()">爆破</button>
  </div>

  <script>
    let currentSlot = 1;
    let data = JSON.parse(localStorage.getItem('umamusumeData')) || {
      1: { grow: 0, kire: 0, cracks: 0 },
      2: { grow: 0, kire: 0, cracks: 0 },
      3: { grow: 0, kire: 0, cracks: 0 }
    };

    function saveData() {
      localStorage.setItem('umamusumeData', JSON.stringify(data));
    }

    function render() {
      const slot = data[currentSlot];
      document.getElementById("title").innerText = `データ${currentSlot}`;
      document.getElementById("grow").innerText = slot.grow;
      document.getElementById("kire").innerText = slot.kire;

      for (let i = 1; i <= 3; i++) {
        document.getElementById(`btn${i}`).classList.remove("active");
      }
      document.getElementById(`btn${currentSlot}`).classList.add("active");
    }

    function selectSlot(slot) {
      currentSlot = slot;
      document.getElementById("card").classList.remove("shake", "fly-away");
      render();
    }

    function increment(type) {
      data[currentSlot][type]++;
      data[currentSlot].cracks = 0; // 爆破カウントリセット
      document.getElementById("card").classList.remove("shake", "fly-away");
      render();
      saveData();
    }

    function resetCounts() {
      data[currentSlot] = { grow: 0, kire: 0, cracks: 0 };
      document.getElementById("card").classList.remove("shake", "fly-away");
      render();
      saveData();
    }

    function explode() {
      const card = document.getElementById("card");
      data[currentSlot].cracks++;
      card.classList.add("shake");

      if (data[currentSlot].cracks >= 5) {
        const randomX = (Math.random() * 800 - 400) + "px";
        const randomY = (Math.random() * -600 - 100) + "px";
        card.style.setProperty("--fly-x", randomX);
        card.style.setProperty("--fly-y", randomY);

        card.classList.remove("shake");
        card.classList.add("fly-away");

        setTimeout(() => {
          resetCounts();
          card.classList.remove("fly-away");
          card.style.setProperty("--fly-x", "300px");
          card.style.setProperty("--fly-y", "-300px");
        }, 800);
      }
      saveData();
    }

    render();
  </script>
</body>
</html>
